--**************************** Load , Log, create folder, move file (1/6/24)CREATE TABLE [dbo].[OM_EMPLOYEE](	[EMPID] [varchar](50) NULL,	[EMPNAME] [varchar](50) NULL,	[ZIPCODE] [varchar](50) NULL,	FILE_ID INT)CREATE PROCEDURE SP_LOGGING_FILE_NAME @NAME_OF_FILE VARCHAR(30), @GRAB_FILE_ID INT OUTPUTASBEGIN INSERT INTO OM_LOG_FILE(FILE_NAME) VALUES (@NAME_OF_FILE)  SELECT @GRAB_FILE_ID = FILE_ID  FROM OM_LOG_FILE WHERE FILE_NAME = @NAME_OF_FILEEND

CREATE TABLE OM_LOG_FILE(FILE_ID INT IDENTITY(1,1),FILE_NAME VARCHAR(50) PRIMARY KEY,LOAD_DTM DATE DEFAULT GETDATE())TRUNCATE TABLE OM_LOG_FILETRUNCATE TABLE OM_EMPLOYEESELECT * FROM OM_LOG_FILESELECT * FROM OM_EMPLOYEE--************************************* 1/12/24CREATE TABLE [dbo].[OM_EMPLOYEE](	[EMPID] [varchar](50) NULL,	[EMPNAME] [varchar](50) NULL,	[ZIPCODE] [varchar](50) NULL,	FILE_ID INT)EXEC SP_LOGGING_FILE_NAMEALTER PROCEDURE SP_LOGGING_FILE_NAME @NAME_OF_FILE VARCHAR(30), @GRAB_FILE_ID INT OUTPUTASBEGIN INSERT INTO INSURANCE_INFO_LOG_FILE(FILE_NAME) VALUES (@NAME_OF_FILE)  SELECT @GRAB_FILE_ID = FILE_ID  FROM INSURANCE_INFO_LOG_FILE WHERE FILE_NAME = @NAME_OF_FILEEND

CREATE TABLE OM_LOG_FILE(FILE_ID INT IDENTITY(1,1),FILE_NAME VARCHAR(50) PRIMARY KEY,LOAD_DTM DATE DEFAULT GETDATE())CREATE PROC SP_LOAD_HISTORY_OM_EMPLOYEEASBEGIN	INSERT INTO [HISTORY_OM_EMPLOYEE]	(EMPID,EMPNAME,ZIPCODE,FILE_ID)	SELECT 	LTRIM(RTRIM(EMPID))	,UPPER(LTRIM(RTRIM(EMPNAME)))	,UPPER(LTRIM(RTRIM(ZIPCODE)))	,FILE_ID	FROM [dbo].[OM_EMPLOYEE]END
--RESETTRUNCATE TABLE OM_LOG_FILETRUNCATE TABLE [HISTORY_OM_EMPLOYEE]SELECT * FROM OM_LOG_FILESELECT * FROM [dbo].[OM_EMPLOYEE]SELECT * FROM [HISTORY_OM_EMPLOYEE]TRUNCATE TABLE OM_LOG_FILETRUNCATE TABLE OM_EMPLOYEESELECT * FROM OM_LOG_FILESELECT * FROM OM_EMPLOYEEDROP TABLE [dbo].[HISTORY_OM_EMPLOYEE]CREATE TABLE [dbo].[HISTORY_OM_EMPLOYEE](	[EMPID] [varchar](50) NULL,	[EMPNAME] [varchar](50) NULL,	[ZIPCODE] [varchar](50) NULL,	FILE_ID INT,	LOAD_DATE DATE DEFAULT GETDATE())--SPCREATE PROC SP_LOAD_HISTORY_OM_EMPLOYEEASBEGIN	INSERT INTO [HISTORY_OM_EMPLOYEE]	(EMPID,EMPNAME,ZIPCODE,FILE_ID)	SELECT 	LTRIM(RTRIM(EMPID))	,UPPER(LTRIM(RTRIM(EMPNAME)))	,UPPER(LTRIM(RTRIM(ZIPCODE)))	,FILE_ID	FROM [dbo].[OM_EMPLOYEE]ENDEXEC SP_LOAD_HISTORY_OM_EMPLOYEE